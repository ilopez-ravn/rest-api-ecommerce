openapi: 3.1.0
info:
  title: Ecommerce
  description: |-
    This is the API documentation for our general purpose ecommerce REST API

    Some useful links:
    - [RESTful API repository](https://github.com/ilopez-ravn/ecommerce)


  contact:
    email: israellopez@ravn.co
  license:
    name: Apache 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0.html
  version: 1.0.0
externalDocs:
  description: Find out more about the functionalities
  url: https://github.com/ilopez-ravn/ecommerce
servers:
  - url: http://localhost:8080/api/v1
  - url: https://ecommerce-api.pacasoft.app/api/v1
tags:
  - name: products
    description: Access to product data
  - name: warehouses
    description: Manage warehouses and stock
  - name: orders
    description: Manage client's orders
  - name: payments
    description: Manage Stripe's payment intents and confirmation
  - name: carts
    description: Operations on carts
  - name: users
    description: Manage the auth actions
  - name: clients
    description: Manage clients
  - name: categories
    description: Manage product categories
  - name: tags
    description: Manage product tags

security:
  - bearerAuth: []  
  
paths:
  /clients:
    get:
      tags:
        - clients
      summary: Get a page of clients
      description: Retrieve a page of clients
      operationId: getClients
      parameters:
        - name: page
          in: query
          description: Page number for pagination
          required: false
          schema:
            type: integer
            default: 1
        - name: page_size
          in: query
          description: Number of clients per page
          required: false
          schema:
            type: integer
            default: 10
        - name: filter
          in: query
          description: Allows search the client by custom text on name or email
          required: false
          explode: true
          schema:
            type: string
        
      responses:
        '200':
          description: List of clients
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ClientPage'
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
                
    post:
      tags:
        - clients
      summary: Create a new client
      description: Create a new client
      operationId: createClient
      requestBody:
        description: Client object that needs to be added
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PostClient'
        required: true
      responses:
        '201':
          description: Client created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FullClient'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"

        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
    
  /clients/{clientId}:

    get:
      tags:
        - clients
      summary: Get client by ID
      description: Get a single client by its unique identifier
      operationId: getClientById
      parameters:
        - name: clientId
          in: path
          description: ID of client to return
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FullClient'
        '400':
          description: Invalid ID supplied
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '404':
          description: Client not found
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    put:
      tags:
        - clients
      summary: Update an existing client by ID
      description: Update an existing client by its unique identifier
      operationId: updateClientById
      parameters:
        - name: clientId
          in: path
          description: ID of client to update
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        description: Client object that needs to be updated
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PostClient'
        required: true
      responses:
        '200':
          description: Client updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FullClient'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '404':
          description: Client not found
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    delete:
      tags:
        - clients
      summary: Delete a client by ID
      description: Delete a single client by its unique identifier
      operationId: deleteClientById
      parameters:
        - name: clientId
          in: path
          description: ID of client to delete
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '204':
          description: Client deleted successfully
        '400':
          description: Invalid ID supplied
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '404':
          description: Client not found
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

                
  /products:
    get:
      tags:
        - products
      summary: Get active products by filters
      description: Get, filter and search active products available
      operationId: getProducts
      parameters:
        - name: filter
          in: query
          description: Allows search the product by custom text on name or description
          required: false
          explode: true
          schema:
            type: string
        - name: categories_id
          in: query
          schema:
            type: array
            items:
              type: integer
              format: int64
          description: Filter products by category ID
          required: false
        - name: tags_id
          in: query
          description: Filter products by tags ID
          required: false
          explode: true
          schema:
            type: array
            items:
              type: integer
              format: int64
        - name: page
          in: query
          description: Page number for pagination
          required: false
          schema:
            type: integer
            default: 1
        - name: page_size
          in: query
          description: Number of products per page
          required: false
          schema:
            type: integer
            default: 10
        - name: sort_by
          in: query
          description: Field to sort the products by (e.g., name, price)
          required: false
          schema:
            type: string
        - name: sort_order
          in: query
          description: Sort order (asc for ascending, desc for descending)
          required: false
          schema:
            type: string
            enum:
              - asc
              - desc
            default: desc
        - name: price_min
          in: query
          description: Filter products with price greater than or equal to this value
          required: false
          schema:
            type: number
            format: float
        - name: price_max
          in: query
          description: Filter products with price less than or equal to this value
          required: false
          schema:
            type: number
            format: float
        - name: available
          in: query
          description: Filter products by availability status
          required: false
          schema:
            type: boolean
            default: true
      
      responses:
        '200':
          description: List of products
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/PaginatedProduct'
        '400':
          description: Invalid filter value
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - {}

    post: 
      tags:
        - products
      summary: Create a new product
      description: Create a new product
      operationId: createProduct
      requestBody:
        description: Product object that needs to be added
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PostProduct'
        required: true
      responses:
        '201':
          description: Product created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Product'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

      

  /products/{productId}/image:
    post:
      tags:
        - products
      summary: Upload an image for a product
      description: Upload a new image for a specific product by its unique identifier
      operationId: uploadProductImage
      parameters:
        - name: productId
          in: path
          description: ID of product to upload the image for
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        description: Image file to upload
        content:
          application/json:
            schema:
              type: object
              properties:
                image_url:
                  type: string
                  example: http://example.com/image.jpg
                is_primary_image:
                  type: boolean
                  example: true
            
        required: true
      responses:
        '201':
          description: Image uploaded successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductImage'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '404':
          description: Product not found
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      
        
  /products/{productId}/image/{imageId}:
    delete:
      tags:
        - products
      summary: Delete an image from a product
      description: Delete an existing image from a specific product by its unique identifier
      operationId: deleteProductImage
      parameters:
        - name: productId
          in: path
          description: ID of product to delete the image from
          required: true
          schema:
            type: integer
            format: int64
        - name: imageId
          in: path
          description: ID of image to delete
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '204':
          description: Image deleted successfully
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '404':
          description: Product or Image not found
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      


  /products/{productId}:
    get:
      tags:
        - products
      summary: Get product by ID
      description: Get a single product by its unique identifier
      operationId: getProductById
      parameters:
        - name: productId
          in: path
          description: ID of product to return
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Product'
        '400':
          description: Invalid ID supplied
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '404':
          description: Product not found
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - {}

    patch:
      tags:
        - products
      summary: Update a product partially
      description: Update a single product by its unique identifier
      operationId: updateProductPartially
      parameters:
        - name: productId
          in: path
          description: ID of product to disable or enable
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        description: Fields to set for the product
        content:
          application/json:
            schema:
              type: object
              properties:
                is_active:
                  type: boolean
        required: true
        
      responses:
        '200':
          description: Product status updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Product'
        '400':
          description: Invalid request body
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '404':
          description: Product not found
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      

    put:
      tags:
        - products
      summary: Update an existing product
      description: Update an existing product
      operationId: updateProduct
      requestBody:
        description: Product object that needs to be updated
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PostProduct'
        required: true
      responses:
        '200':
          description: Product updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Product'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
                
        '404':
          description: Product not found
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      
    
                
    delete:
      tags:
        - products
      summary: Delete a product
      description: Delete a product
      operationId: deleteProduct
      parameters:
        - name: productId
          in: query
          description: ID of product to delete
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '204':
          description: Product deleted successfully
        '400':
          description: Invalid request body
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
                
        '404':
          description: Product not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      

  /products/{productId}/liked:
    put:
      tags:
        - products
      summary: Like a product for a specific client
      description: Like for a specific client 
      operationId: likeProduct
      parameters:
        - name: productId
          in: path
          description: ID of product to like
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        description: User id that likes the product
        content:
          application/json:
            schema:
              type: object
              properties:
                client_id:
                  type: integer
                  format: int64
        required: true

      responses:
        '200':
          description: Product like status updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Product liked successfully
        '400':
          description: Invalid ID supplied
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
                
        '404':
          description: Product not found
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      

                
    delete:
      tags:
        - products
      summary: Unlike a product for a specific client
      description: Unlike a product for a specific client 
      operationId: unlikeProduct
      parameters:
        - name: productId
          in: path
          description: ID of product to unlike
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        description: User id that unlikes the product
        content:
          application/json:
            schema:
              type: object
              properties:
                client_id:
                  type: integer
                  format: int64
        required: true

      responses:
        '204':
          description: Product unlike status updated successfully
        '400':
          description: Invalid ID supplied
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
                
        '404':
          description: Product not found
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      

                
  /warehouses:
    get:
      tags:
        - warehouses
      summary: Get all warehouses
      description: Retrieve a list of all warehouses
      operationId: getWarehouses
      responses:
        '200':
          description: List of warehouses
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Warehouse'
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
    post:
      tags:
        - warehouses
      summary: Create a new warehouse
      description: Create a new warehouse
      operationId: createWarehouse
      requestBody:
        description: Warehouse object that needs to be added
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PostWarehouse'
        required: true
      responses:
        '201':
          description: Warehouse created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Warehouse'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
                
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      
  
  /warehouses/{warehouseId}:
    put:
      tags:
        - warehouses
      summary: Update an existing warehouse
      description: Update an existing warehouse by its unique identifier
      operationId: updateWarehouse
      parameters:
        - name: warehouseId
          in: path
          description: ID of warehouse to update
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        description: Warehouse object that needs to be updated
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PostWarehouse'
        required: true
      responses:
        '200':
          description: Warehouse updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Warehouse'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
                
        '404':
          description: Warehouse not found
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      

    delete:
      tags:
        - warehouses
      summary: Delete a warehouse by ID
      description: Delete a single warehouse by its unique identifier
      operationId: deleteWarehouseById
      parameters:
        - name: warehouseId
          in: path
          description: ID of warehouse to delete
          required: true
          schema:
            type: integer
            format: int64
      
      responses:
        '204':
          description: Warehouse deleted successfully
        '400':
          description: Invalid ID supplied
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
                
        '404':
          description: Warehouse not found
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      

  /warehouses/{warehouseId}/stock:
    post:
      tags:
        - warehouses
      summary: Update stock levels for multiple products
      description: Update stock levels for multiple products
      operationId: updateProductStocks
      requestBody:
        description: List of product stock updates
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ProductStockUpdateList'
        required: true
      responses:
        '200':
          description: Product stocks updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Product stocks updated successfully
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
                
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      

  /users:
    post:
      tags:
        - users
      summary: Create a new user
      description: Create a new user
      operationId: createUser
      requestBody:
        description: User object that needs to be added
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateUser'
      responses:
        '201':
          description: User created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
                
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      

  
  /users/login:
    post:
      tags:
        - users
      summary: Logs user into the system.
      description: Log user into the system.
      operationId: loginUser
      requestBody:
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                username:
                  type: string
                password:
                  type: string
      responses:
        '201':
          description: Successful operation
          headers:
            X-Rate-Limit:
              description: calls per hour allowed by the user
              schema:
                type: integer
                format: int32
            X-Expires-After:
              description: date in UTC when token expires
              schema:
                type: string
                format: date-time
          content:
            application/json:
              schema:
                properties:
                  access_token:
                    type: string

        '400':
          description: Invalid username/password supplied
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
                

        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - {}

  /users/refresh:
    post:
      tags:
        - users
      summary: Refresh JWT token
      description: Refresh the JWT token for an authenticated user
      operationId: refreshToken
      requestBody:
        description: Refresh token object
        content:
          application/json:
            schema:
              type: object
              properties:
                refresh_token:
                  type: string
        required: true
      responses:
        '200':
          description: Token refreshed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  access_token:
                    type: string
        '401':
          description: Unauthorized - Invalid or expired token
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UnauthorizedResponse"
        '400':
          description: Invalid refresh token supplied
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
                
        
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - {}

  /users/password/token:
    post:
      tags:
        - users
      summary: Initiate password reset
      description: Initiate the password reset process for a user
      operationId: forgotPassword
      requestBody:
        description: User email for password reset
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  format: email

        required: true
      responses:
        '200':
          description: Password reset initiated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Password reset link sent to email
        '400':
          description: Invalid email supplied
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
                
          
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - {}

  /users/password:
    put:
      tags:
        - users
      summary: Reset user password
      description: Reset the password for a user using a reset token
      operationId: resetPassword
      requestBody:
        description: Password reset data
        content:
          application/json:
            schema:
              type: object
              properties:
                reset_token:
                  type: string
                new_password:
                  type: string
        required: true
      responses:
        '200':
          description: Password reset successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Password has been reset successfully
        '400':
          description: Invalid reset token or password supplied
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
                
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - {}

  /users/{userId}:
    get:
      tags:
        - users
      summary: Get user by ID.
      description: Get user details base on ID.
      operationId: getUserByID
      parameters:
        - name: userId
          in: path
          description: The ID that needs to be fetched. Use 1 for testing
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '400':
          description: Invalid user ID supplied
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
                
        '404':
          description: User not found
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    put: 
      tags:
        - users
      summary: Update an existing user by ID
      description: Update an existing user by its unique identifier
      operationId: updateUserById
      parameters:
        - name: userId
          in: path
          description: ID of user to update
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        description: User object that needs to be updated
        content:
          application/json:
            schema:
              type: object
              properties:
                username:
                  type: string
                password:
                  type: string
                role_id:
                  type: integer
                  format: int64
                phone:
                  type: string
                email:
                  type: string
                  format: email

                first_name:
                  type: string
                last_name:
                  type: string
        required: true
      responses:
        '200':
          description: User updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    format: int64
                  username:
                    type: string
                  email:
                    type: string
                    format: email
                  first_name:
                    type: string
                  last_name:
                    type: string
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"

        '404':
          description: User not found
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    delete:
      tags:
        - users
      summary: Delete a user by ID
      description: Delete a single user by its unique identifier
      operationId: deleteUserById
      parameters:
        - name: userId
          in: path
          description: ID of user to delete
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '204':
          description: User deleted successfully
        '400':
          description: Invalid ID supplied
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"

        '404':
          description: User not found
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      


    patch:
      tags:
        - users
      summary: Disable or enable a user by ID
      description: Disable or enable a single user by its unique identifier
      operationId: disableOrEnableUserById
      parameters:
        - name: userId
          in: path
          description: ID of user to disable or enable
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        description: Status to set for the user
        content:
          application/json:
            schema:
              type: object
              properties:
                status:
                  type: boolean
        required: true

      responses:
        '200':
          description: User status updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: User status updated successfully
        '400':
          description: Invalid ID supplied
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"

        '404':
          description: User not found
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      

  /stripe/payment:
    put:
      tags:
        - payments
      summary: Create or retrieve a Stripe Payment Intent for the shopping cart
      description: Create or retrieve a Stripe Payment Intent for processing payments
      operationId: createPaymentIntent
      requestBody:
        description: Payment intent data
        content:
          application/json:
            schema:
              type: object
              properties:
                shopping_cart_id:
                  type: integer
                  format: int64
                  
        required: true
      responses:
        '201':
          description: Payment Intent created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaymentIntent'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"

        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      

  /orders/status/{shoppingCartId}:
    get:
      tags:
        - orders
      summary: Get payment status for an order
      description: After a payment is made, the client will wait for the payment to be processed and then retrieve the order details using the shopping cart ID
      operationId: getPaymentStatus
      parameters:
        - name: shoppingCartId
          in: path
          description: ID of the shopping cart to retrieve payment status for
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Payment status retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Order'
        '400':
          description: Invalid ID supplied
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"

        '404':
          description: Order not found
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      


  /stripe/webhook:
    post:
      tags:
        - payments
      summary: Stripe Webhook Endpoint
      description: Endpoint to handle payment intent status
      operationId: handleStripeWebhook
      parameters:
        - name: stripe-signature
          in: header
          description: Stripe signature header used to verify the webhook payload
          required: true
          schema:
            type: string
      requestBody:
        description: Stripe webhook event data
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StripeWebhookEvent'
        required: true
      responses:
        '200':
          description: Webhook event processed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Webhook event processed successfully
        '400':
          description: Invalid webhook event data
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"

        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - {}
  /orders:
    get:
      tags:
        - orders
      summary: Get all orders
      description: Retrieve a list of all orders placed
      operationId: getOrders
      parameters:
        - name: client_id
          in: query
          description: Filter orders by client ID
          required: false
          schema:
            type: integer
            format: int64
        - name: status
          in: query
          description: Filter orders by status
          required: false
          schema:
            type: string
            enum:
              - pending
              - approved
              - preparing
              - delivered
              - delayed
        - name: page
          in: query
          description: Page number for pagination
          required: false
          schema:
            type: integer
            default: 1
        - name: page_size
          in: query
          description: Number of orders per page
          required: false
          schema:
            type: integer
            default: 10

        - name: sort_by
          in: query
          description: Field to sort the orders by (e.g., date, total_amount)
          required: false
          schema:
            type: string
        - name: sort_order
          in: query
          description: Sort order (asc for ascending, desc for descending)
          required: false
          schema:
            type: string
            enum:
              - asc
              - desc
            default: desc
        - name: date_from
          in: query
          description: Filter orders from this date (YYYY-MM-DD)
          required: false
          schema:
            type: string
            format: date
        - name: date_to
          in: query
          description: Filter orders up to this date (YYYY-MM-DD)
          required: false
          schema:
            type: string
            format: date

      responses:
        '200':
          description: List of orders
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Order'
        '400':
          description: Invalid filter value
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"

        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    put:
      tags:
        - orders
      summary: Create a new order
      description: Create a new order based on the cart choosing the address and the warehouse where products will come from
      operationId: createOrder
      requestBody:
        description: Order data needed for billing and tracking
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NewOrder'
        required: true
      responses:
        '201':
          description: Order created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Order'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"

        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"


  /orders/{orderId}:
    get:
      tags:
        - orders
      summary: Get order by ID
      description: Retrieve an order by its unique identifier
      operationId: getOrderById
      parameters:
        - name: orderId
          in: path
          description: ID of order to retrieve
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Order'
        '400':
          description: Invalid ID supplied
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"

        '404':
          description: Order not found
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    delete:
      tags:
        - orders
      summary: Delete an order by ID
      description: Delete a single order by its unique identifier
      operationId: deleteOrderById
      parameters:
        - name: orderId
          in: path
          description: ID of order to delete
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '204':
          description: Order deleted successfully
        '400':
          description: Invalid ID supplied
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"

        '404':
          description: Order not found
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      

  /orders/{orderId}/shipping:
    get:
      tags:
        - orders
      summary: Get shipping details for an order
      description: Retrieve shipping information for a specific order
      operationId: getOrderShippingDetails
      parameters:
        - name: orderId
          in: path
          description: ID of order to retrieve shipping details for
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Shipping details retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ShippingDetails'
        '400':
          description: Invalid ID supplied
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"

        '404':
          description: Order not found
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    post:
      tags:
        - orders
      summary: Update shipping stauts for an order
      description: Update shipping status for a specific order
      operationId: updateOrderShippingStatus
      parameters:
        - name: orderId
          in: path
          description: ID of order to update shipping status for
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        description: Shipping status data
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ShippingStatusUpdate'
      responses:
        '200':
          description: Shipping status updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ShippingDetails'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"

        '404':
          description: Order not found
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /carts:
    post: 
      tags:
        - carts
      summary: Create a new cart
      description: Create a new cart
      operationId: createCart

      requestBody:
        description: Cart object that needs to be added
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NewCart'
        required: true
      responses:
        '201':
          description: Cart created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Cart'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"

        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /carts/{cartId}:
    get:
      tags:
        - carts
      summary: Get cart by ID
      description: Retrieve a cart by its unique identifier
      operationId: getCartById
      parameters:
        - name: cartId
          in: path
          description: ID of cart to retrieve
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Cart'
        '400':
          description: Invalid ID supplied
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"

        '404':
          description: Cart not found
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    put: 
      tags:
        - carts
      summary: Update cart by ID
      description: Allow to assign client id, cart status and clear products list
      operationId: updateCartById
      parameters:
        - name: cartId
          in: path
          description: ID of cart to update
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        description: Cart object that needs to be updated
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateCart'
        required: true
      responses:
        '200':
          description: Cart updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Cart'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"

        '404':
          description: Cart not found
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    delete: 
      tags:
        - carts
      summary: Delete cart by ID
      description: Delete a single cart by its unique identifier
      operationId: deleteCartById
      parameters:
        - name: cartId
          in: path
          description: ID of cart to delete
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '204':
          description: Cart deleted successfully
        '400':
          description: Invalid ID supplied
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"

        '404':
          description: Cart not found
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /carts/{cartId}/items:
    post:
      tags:
        - carts
      summary: Add product to cart
      description: Add a product to an existing cart
      operationId: addProductToCart
      requestBody:
        description: Product and cart information to add the product to the cart
        content:
          application/json:
            schema:
              type: object
              properties:
                product_id:
                  type: integer
                  format: int64
                quantity:
                  type: integer
      responses:
        '201':
          description: Product added to cart successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Cart'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"

        '404':
          description: Cart or Product not found
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /carts/{cartId}/items/{itemId}:
    patch:
      tags:
        - carts
      summary: Update product quantity in cart
      description: Update the quantity of a specific product in an existing cart
      operationId: updateProductQuantityInCart
      parameters:
        - name: itemId
          in: path
          description: ID of item to update in the cart
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        description: Cart ID and new quantity for the cart item
        content:
          application/json:
            schema:
              type: object
              properties:
                quantity:
                  type: integer
        required: true
      responses:
        '200':
          description: Product quantity updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Cart'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"

        '404':
          description: Cart or Product not found
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    delete:
      tags:
        - carts
      summary: Remove product from cart
      description: Remove a specific product from an existing cart
      operationId: removeProductFromCart
      parameters:
        - name: cartId
          in: path
          description: ID of product to remove from the cart
          required: true
          schema:
            type: integer
            format: int64
        - name: cardDetailId
          in: path
          description: ID of cart to remove the product from
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '204':
          description: Product removed from cart successfully
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"

        '404':
          description: Cart or Product not found
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        

  /carts/clients/{clientId}:
    get:
      tags:
        - carts
      summary: Get or create cart by client ID
      description: Retrieve the cart for a specific client by their unique identifier, retrieves an active cart
      operationId: getCartByClientId
      parameters:
        - name: clientId
          in: path
          description: ID of client to retrieve the cart for
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Cart'
        '400':
          description: Invalid ID supplied
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"

        '404':
          description: Cart not found
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      


  /categories:
    get:
      tags:
        - categories
      summary: Get all product categories
      description: Retrieve a list of all product categories available
      operationId: getCategories
      responses:
        '200':
          description: List of product categories
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Category'
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - {}

    post:
      tags:
        - categories
      summary: Create a new product category
      description: Create a new category for products
      operationId: createCategory
      requestBody:
        description: Category object that needs to be added
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/newCategory'
        required: true
      responses:
        '201':
          description: Category created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Category'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"

        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      

  /categories/{categoryId}:
    put:
      tags:
        - categories
      summary: Update an existing product category
      description: Update an existing category
      operationId: updateCategory
      parameters:
        - name: categoryId
          in: path
          description: ID of category to update
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        description: Category object that needs to be updated
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/newCategory'
        required: true
      responses:
        '200':
          description: Category updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Category'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"

        '404':
          description: Category not found
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      

    delete:
      tags:
        - categories
      summary: Delete a product category
      description: Delete a category
      operationId: deleteCategory
      parameters:
        - name: categoryId
          in: path
          description: ID of category to delete
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '204':
          description: Category deleted successfully
        '400':
          description: Invalid ID supplied
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"

        '404':
          description: Category not found
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      


  /tags:
    get:
      tags:
        - tags
      summary: Get all product tags
      description: Retrieve a list of all product tags available
      operationId: getTags
      responses:
        '200':
          description: List of product tags
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Tag'
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      security:
        - {}

    post:
      tags:
        - tags
      summary: Create a new product tag
      description: Create a new tag for products
      operationId: createTag
      requestBody:
        description: Tag object that needs to be added
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NewTag'
        required: true
      responses:
        '201':
          description: Tag created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Tag'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      

  /tags/{tagId}:
    put:
      tags:
        - tags
      summary: Update an existing product tag
      description: Update an existing tag
      operationId: updateTag
      parameters:
        - name: tagId
          in: path
          description: ID of tag to update
          required: true
          schema:
            type: integer
            format: int64
      requestBody:
        description: Tag object that needs to be updated
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NewTag'
        required: true
      responses:
        '200':
          description: Tag updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Tag'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"

        '404':
          description: Tag not found
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      

    delete:
      tags:
        - tags
      summary: Delete a product tag
      description: Delete a tag
      operationId: deleteTag
      parameters:
        - name: tagId
          in: path
          description: ID of tag to delete
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '204':
          description: Tag deleted successfully
        '400':
          description: Invalid ID supplied
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '429':
          description: Too many requests - rate limit exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InvalidQueryResponse"
        '404':
          description: Tag not found
        '500':
          description: Unexpected error
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
      



components:
  schemas:
    Product:
      type: object
      properties:
        id:
          type: integer
          format: int64
          example: 10
        name:
          type: string
          example: "Lavadora"
        description:
          type: string
          example: "Lorem ipsum" 
        created_by:
          type: integer
          format: int64
          example: 1
        price:
          type: number
          example: 19.99 
        category_list:
          type: array
          items:
            type: integer
            format: int64
        tag_list:
          type: array
          items:
            type: integer
            format: int64
        product_images:
          type: array
          items:
            $ref: '#/components/schemas/ProductImage'

    PaginatedProduct:
      type: object
      properties:
        page_info:
          $ref: '#/components/schemas/PageInfo'
        items:
          type: array
          items:
            $ref: '#/components/schemas/Product'


    PageInfo:
      type: object
      properties:
        current_page:
          type: integer
          example: 1
        page_size:
          type: integer
          example: 10
        total_pages:
          type: integer
          example: 5
        total_items:
          type: integer
          example: 50
    
    PostProduct:
      type: object
      required:
        - name
        - price
      properties:
        name:
          type: string
          example: "Lavadora"
        description:
          type: string
          example: "Lorem ipsum" 
        created_by:
          type: integer
          format: int64
          example: 1
        price:
          type: number
          example: 19.99 
        category_list:
          type: array
          items:
            type: integer
            format: int64
        tag_list: 
          type: array
          items:
            type: integer
            format: int64
        image_list:
          type: array
          items:
            $ref: '#/components/schemas/NewProductImage'

    ProductImage:
      type: object
      required:
        - product_id
        - image_url
      properties:
        id:
          type: integer
          format: int64
          example: 1
        product_id:
          type: integer
          format: int64
          example: 10
        image_url:
          type: string
          example: "https://example.com/image.jpg"
        is_primary_image:
          type: boolean
          example: true
        
    NewProductImage:
      type: object
      required:
        - product_id
        - image_url
      properties:
        product_id:
          type: integer
          format: int64
          example: 10
        image_url:
          type: string
          example: "https://example.com/image.jpg"
        is_primary_image:
          type: boolean
          example: true
        
      
    NewOrder:
      type: object
      required:
        - warehouse_id
        - cart_id
        - address_id
      properties:
        warehouse_id:
          type: integer
          format: int64
          example: 1
        cart_id:
          type: integer
          format: int64
          example: 5
        address_id:
          type: integer
          format: int64
          example: 3


    Order:
      type: object
      properties:
        id:
          type: integer
          format: int64
          example: 10
        client_id:
          type: integer
          format: int64
          example: 32
        warehouse_id:
          type: integer
          format: int64
          example: 1
        order_date:
          type: string
          format: date-time
        bill_info:
          $ref: "#/components/schemas/BillingInformation"
        address_info:
          $ref: '#/components/schemas/Address'
        payment_info:
          $ref: '#/components/schemas/stripePayment'
   
    UpdateCart:
      type: object
      required:
        - client_id
        - status
      properties:
        client_id:
          type: integer
          format: int64
          example: 10
        status: 
          type: string
          example: open
       
    NewCart:
      type: object
      required:
        - status
        - products
      properties:
        id:
          type: integer
          format: int64
          example: 1
        status: 
          type: string
          example: open
        products:
          type: array
          items:
            $ref: '#/components/schemas/NewCartDetail'

    Cart:
      type: object
      properties:
        id:
          type: integer
          format: int64
          example: 1
        client_id:
          type: integer
          format: int64
          example: 10
        status: 
          type: string
          example: open
        products:
          type: array
          items:
            $ref: '#/components/schemas/CartDetail'
    
    
    CartDetail: 
      type: object
      properties:
        id:
          type: integer
          format: int64
          example: 1
        price:
          type: number
          format: float
          example: 19.99
        quantity:
          type: integer
          example: 3 
        total:
          type: number
          format: float
          example: 59.97

        product:
            $ref: '#/components/schemas/Product'

    NewCartDetail: 
      type: object
      required:
        - price
        - quantity
        - product_id
      properties:
        price:
          type: number
          format: float
          example: 19.99
        quantity:
          type: integer
          example: 3 
        product_id:
          type: integer
          format: int64
          example: 10
            
    CartDetailUpdate: 
      type: object
      required:
        - id
        - price
        - quantity
        - product_id
      properties:
        id:
          type: integer
          format: int64
          example: 1
        price:
          type: number
          format: float
          example: 19.99
        quantity:
          type: integer
          example: 3 

        product_id:
          type: integer
          format: int64
          example: 10
            

    Category:
      type: object
      properties:
        id:
          type: integer
          format: int64
          example: 1
        name:
          type: string
          example: Electronics

    newCategory:
      type: object
      required:
        - name
      properties:
        name:
          type: string
          example: Electronics

    User:
      type: object
      properties:
        id:
          type: integer
          format: int64
          example: 10
        first_name:
          type: string
          example: theEmployee
        last_name:
          type: string
          example: Jane
        email:
          type: string
          format: email
          example: Doe
        phone:
          type: string
          example: '12345'
        user_id: 
          type: integer
          format: int64
          example: 5

    CreateUser:
      type: object
      required: 
        - username
        - password
        - first_name
        - last_name
        - email
      properties:
        username:
          type: string
          example: admin
        password:
          type: string
          example: StrongPassword123
        role: 
          type: string
          example: manager
        first_name:
          type: string
          example: Israel
        last_name:
          type: string
          example: Lopez
        email:
          type: string
          format: email
          example: israellopez@ravn.co
        phone:
          type: string
          example: '12345'
        
    ClientPage: 
      type: object
      properties:
        page_info:
          $ref: '#/components/schemas/PageInfo'
        items:
          type: array
          items:
            $ref: '#/components/schemas/Client'
    Client: 
      type: object
      properties:
        id:
          type: integer
          format: int64
          example: 10
        first_name:
          type: string
          example: Israel
        last_name:
          type: string
          example: Lopez
        email:
          type: string
          format: email
          example: israellopez@ravn.co
        phone:
          type: string
          example: "12345"
        document:
          type: string
          example: "DNI"
        document_type:
          type: string
          example: "123"

    FullClient: 
      type: object
      properties:
        id:
          type: integer
          format: int64
          example: 10
        first_name:
          type: string
          example: Israel
        last_name:
          type: string
          example: "Lopez"
        email:
          type: string
          format: email
          example: "israellopez@ravn.co"
        phone:
          type: string
          example: "12345"
        document:
          type: string
          example: "DNI"
        document_type:
          type: string
          example: "123"
        address: 
          $ref: '#/components/schemas/Address'

    PostClient:
      type: object
      required: 
        - first_name
        - last_name
        - email
        - document
        - document_type
        - address
      properties:
        first_name:
          type: string
          example: Israel
        last_name:
          type: string
          example: "Lopez"
        email:
          type: string
          format: email
          example: "israellopez@ravn.co"
        phone:
          type: string
          example: "12345"
        document:
          type: string
          example: "DNI"
        document_type:
          type: string
          example: "12345678"
        address: 
          $ref: '#/components/schemas/PostAddress'

    ShippingDetails:
      type: object
      properties:
        delivery_tracking:
          $ref: '#/components/schemas/DeliveryTracking'
        history:
          type: array
          items:
            $ref: '#/components/schemas/DeliveryHistoryLog'
        address:
          $ref: '#/components/schemas/Address'    
    
    ShippingStatusUpdate:
      type: object
      required:
        - status_id
        - changed_by
      properties:
        status_id:
          type: integer
          example: 1
        changed_by:
          type: integer
          format: int64
          example: 5

          

    DeliveryHistoryLog:
      type: object
      properties:
        id:
          type: integer
          format: int64
          example: 1
        previous_status:
          type: string
          example: pending
          enum:
            - pending
            - approved
            - preparing
            - delivered
            - delayed
        new_status:
          type: string
          example: approved
          enum:
            - pending
            - approved
            - preparing
            - delivered
            - delayed
        changed_by:
          $ref: '#/components/schemas/User'
        changed_at:
          type: string
          format: date-time

    DeliveryTracking:
      type: object
      properties:
        id:
          type: integer
          format: int64
          example: 1
        order_id:
          type: integer
          format: int64
          example: 10
        address_id:
          type: integer
          format: int64
          example: 3
        tracking_number:
          type: string
          example: TRK123456
        assigned_to:
          type: integer
          format: int64
          example: 5
        status:
          type: string
          example: pending
          enum:
            - pending
            - approved
            - preparing
            - delivered
            - delayed
        estimated_delivery_date:
          type: string
          format: date-time

    BillingInformation:
      type: object
      properties:
        document_number:
          type: string
          example: "FA123"
        document_type:
          type: string
          example: "invoice"
        total_amount:
          type: number
          format: float
          example: 150.75
        tax_amount:
          type: number
          format: float
          example: 27.14
        delivery_fee:
          type: number
          format: float
          example: 5.00


    stripePayment:
      type: object
      properties:
        id:
          type: integer
          format: int64
          example: 1
        order_id:
          type: integer
          format: int64
          example: 10
        payment_type:
          type: string
          example: stripe
        amount:
          type: number
          format: float
          example: 150.75
        currency:
          type: string
          example: USD
        status:
          type: string
          example: succeeded
          enum:
            - succeeded
            - pending
            - failed
        payment_method:
          type: string
          example: card

    Address:
      type: object
      properties:
        id:
          type: integer
          format: int64
          example: 1
        client_id:
          type: integer
          format: int64
          example: 10 
        address_line1:
          type: string
          example: "123 Main Street"
        address_line2:
          type: string
          example: "Apt 4B"
        city:
          type: string
          example: "Lima"
        state:
          type: string
          example: "Lima"
        postal_code:
          type: string
          example: "15001"
        country:
          type: string
          example: "Peru"
        created_at:
          type: string
          format: date-time

    PostAddress:
      type: object
      required: 
        - address_line1
        - city
        - state
        - country
        - postal_code
      properties:
        address_line1:
          type: string
          example: "123 Main Street"
        address_line2:
          type: string
          example: "Apt 4B"
        city:
          type: string
          example: "Lima"
        state:
          type: string
          example: "Lima"
        postal_code:
          type: string
          example: "15001"
        country:
          type: string
          example: "Peru"
          default: "Peru"

    Warehouse:
      type: object
      properties:
        id:
          type: integer
          format: int64
          example: 1
        name:
          type: string
          example: "Main Warehouse"
        location:
          type: string
          example: "123 Warehouse St, City, Country"
    
    PostWarehouse:
      type: object
      required: 
        - name
        - location
      properties:
        name:
          type: string
          example: "Main Warehouse"
        location:
          type: string
          example: "123 Warehouse St, City, Country"

    ProductStockUpdateList:
      type: object
      required: 
        - product_id
        - type
        - quantity
      properties:
        product_id:
          type: integer
          format: int64
        type:
          type: string
          enum:
            - increase
            - decrease
        quantity:
          type: integer

    Tag:
      type: object
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string

    NewTag:
      type: object
      required:
        - name
      properties:
        name:
          type: string

    ApiResponse:
      type: object
      properties:
        code:
          type: integer
          format: int32
        type:
          type: string
        message:
          type: string
    Error:
      type: object
      properties:
        code:
          type: number
          example: 500
        message:
          type: string
          example: "Internal server error"
      required:
        - code
        - message
    PaymentIntent:
      type: object
      description: Returns the client secret to the frontend to show the payment popup
      properties:
        client_secret:
          type: string
          example: "pi_1FHeJ2Lz0qyl6XeWz1XqL8jT_secret_123"


    StripeWebhookEvent:
      type: object
      properties:
        id:
          type: string
          example: "evt_1FHeJ2Lz0qyl6XeWz1XqL8jT"
        object:
          type: string
          example: "event"
        api_version:
          type: string
          example: "2020-08-27"
        created:
          type: integer
          example: 1700000000
        data:
          type: object
          properties:
            object:
              $ref: '#/components/schemas/StripeWebhookData'
        livemode:
          type: boolean
          example: false
        type:
          type: string
          example: "payment_intent.succeeded"
    StripeWebhookData:
      type: object
      properties:
        id:
          type: string
          example: "evt_1FHeJ2Lz0qyl6XeWz1XqL8jT"
        object:
          type: string
          example: "payment_intent"
        amount:
          type: number
          example: 2000
        amount_received:
          type: number
          example: 2000
        confirmation_method:
          type: string
          example: "automatic_async"
        created:
          type: integer
          example: 1700000000
        currency:
          type: string
          example: [usd]
        customer:
          type: string
          example: null
        customer_account:
          type: string
          example: null
        description:
          type: string 
          example: "Created by Stripe CI"
        latest_charge:
          type: string
          example: "ch_1FHeJ2Lz0qyl6XeWz1XqL8jT"
        payment_method:
          type: string
          example: "pm_card_visa"
        livemode:
          type: boolean
          example: false
        payment_method_options:
          type: object
        last_payment_error:
          type: object
        
        payment_method_types:
          type: array
          items:
            type: string
          example: card
        shipping:
          type: object
        status: 
          type: string
          example: succeeded
        

    InvalidQueryResponse:
      type: object
      properties:
        code:
          type: integer
          format: int32
          example: 400
        message:
          type: string
          example: "Invalid query parameter"
      required:
        - code
        - message
    RateLimitingResponse:
      type: object
      properties:
        code:
          type: integer
          format: int32
          example: 429
        message:
          type: string
          example: "Too many requests - Rate limit exceeded"
    UnauthorizedResponse:
      type: object
      properties:
        code:
          type: integer
          format: int32
          example: 401
        message:
          type: string
          example: "Unauthorized - Invalid or expired token"
      required:
        - code
        - message
  # requestBodies:
  securitySchemes:
    bearerAuth: # arbitrary name for the security scheme
      type: http
      scheme: bearer
      bearerFormat: JWT # optional, arbitrary value for documentation purposes
      